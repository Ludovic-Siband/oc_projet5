<main class="container">
  <div class="register__inner">
    <section class="register__panel">
    <a class="register__back" matButton routerLink="/">⟵</a>
    <img class="register__logo" src="assets/logo_p6.png" alt="Logo MDD" />
    <h1 class="register__title">Inscription</h1>

    <form class="register__form" [formGroup]="form" (ngSubmit)="submit()">
      <mat-form-field appearance="outline" class="register__field">
        <mat-label>Nom d'utilisateur</mat-label>
        <input matInput formControlName="username" autocomplete="username" data-cy="register-username" />
        @if (form.controls.username.touched && form.controls.username.hasError('required')) {
          <mat-error>Le nom d'utilisateur est requis.</mat-error>
        }
        @if (form.controls.username.touched && form.controls.username.hasError('minlength')) {
          <mat-error>Le nom d'utilisateur doit contenir au moins 3 caractères.</mat-error>
        }
        @if (form.controls.username.touched && form.controls.username.hasError('maxlength')) {
          <mat-error>Le nom d'utilisateur ne peut pas dépasser 50 caractères.</mat-error>
        }
        @if (form.controls.username.touched && form.controls.username.hasError('server')) {
          <mat-error>{{ form.controls.username.getError('server') }}</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="register__field">
        <mat-label>Adresse e-mail</mat-label>
        <input matInput formControlName="email" autocomplete="email" data-cy="register-email" />
        @if (form.controls.email.touched && form.controls.email.hasError('required')) {
          <mat-error>L'adresse e-mail est requise.</mat-error>
        }
        @if (form.controls.email.touched && form.controls.email.hasError('email')) {
          <mat-error>Le format d'e-mail est invalide.</mat-error>
        }
        @if (form.controls.email.touched && form.controls.email.hasError('server')) {
          <mat-error>{{ form.controls.email.getError('server') }}</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" class="register__field">
        <mat-label>Mot de passe</mat-label>
        <input
          matInput
          type="password"
          formControlName="password"
          autocomplete="new-password"
          data-cy="register-password"
        />
        @if (form.controls.password.touched && form.controls.password.hasError('required')) {
          <mat-error>Le mot de passe est requis.</mat-error>
        }
        @if (form.controls.password.touched && form.controls.password.hasError('minlength')) {
          <mat-error>Le mot de passe doit contenir au moins 8 caractères.</mat-error>
        }
        @if (form.controls.password.touched && form.controls.password.hasError('pattern')) {
          <mat-error>
            Le mot de passe doit contenir 1 minuscule, 1 majuscule, 1 chiffre et 1 caractère spécial.
          </mat-error>
        }
        @if (form.controls.password.touched && form.controls.password.hasError('server')) {
          <mat-error>{{ form.controls.password.getError('server') }}</mat-error>
        }
      </mat-form-field>

      <button
        class="register__submit"
        matButton="filled"
        color="primary"
        type="submit"
        [disabled]="loading() || form.invalid"
        data-cy="register-submit"
      >
        S'inscrire
      </button>
    </form>
    </section>
  </div>
</main>
